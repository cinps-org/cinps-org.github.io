<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Teacher Class Update</title>

<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
*{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
body{margin:0;padding:16px;background:#f2f4f7;color:#111}
.container{max-width:900px;margin:auto}

.header{text-align:center;margin-bottom:18px}
.header h1{font-size:22px;margin:0}
.header p{margin:5px 0 0;font-size:14px;color:#555}

.card{
  background:#fff;
  border-radius:16px;
  padding:18px;
  margin-bottom:16px;
  box-shadow:0 6px 18px rgba(0,0,0,.06)
}

.card h3{
  font-size:17px;
  margin:0 0 14px;
  padding-bottom:8px;
  border-bottom:1px solid #eee
}

label{display:block;font-size:14px;font-weight:600;margin-bottom:6px}

input,select,textarea{
  width:100%;
  font-size:17px;
  padding:16px;
  border-radius:12px;
  border:1px solid #ccc;
  margin-bottom:14px;
  background:#fff
}

input[readonly]{background:#f5f6f8}
textarea{min-height:120px;resize:vertical}

.time-row{display:flex;gap:10px;margin-bottom:14px}
.time-row select{flex:1}

button{
  width:100%;
  font-size:18px;
  padding:18px;
  border-radius:14px;
  background:#0a4fd8;
  color:#fff;
  border:none;
  font-weight:600;
  cursor:pointer
}

button:disabled{background:#9bb6f0}

.login-box{text-align:center;margin-bottom:16px}

/* ===== POPUP MODAL ===== */
.popup-overlay{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:10000;
}

.popup-card{
  background:#ffffff;
  width:90%;
  max-width:380px;
  padding:28px 22px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 15px 40px rgba(0,0,0,0.25);
  animation:popupFade .25s ease-out;
}

@keyframes popupFade{
  from{transform:scale(.9);opacity:0}
  to{transform:scale(1);opacity:1}
}

.loader{
  width:60px;height:60px;
  border:6px solid #eee;
  border-top:6px solid #0a4fd8;
  border-radius:50%;
  margin:auto;
  animation:spin 1s linear infinite;
}

@keyframes spin{100%{transform:rotate(360deg)}}

.checkmark{
  width:90px;height:90px;margin:auto
}

.checkmark svg{width:90px;height:90px}

.checkmark circle{
  stroke:#28a745;
  stroke-width:6;
  fill:none;
  stroke-dasharray:251;
  stroke-dashoffset:251;
  animation:drawCircle .6s ease-out forwards;
}

.checkmark path{
  stroke:#28a745;
  stroke-width:6;
  fill:none;
  stroke-dasharray:50;
  stroke-dashoffset:50;
  animation:drawTick .4s .6s ease-out forwards;
}

@keyframes drawCircle{to{stroke-dashoffset:0}}
@keyframes drawTick{to{stroke-dashoffset:0}}

</style>
</head>

<body>
<div class="container">

<div class="header">
  <h1>Teacher Class Update</h1>
  <p>Chandidas Institute of Nursing & Paramedical Science</p>
</div>

<!-- GOOGLE LOGIN -->
<div class="login-box" id="loginBox">
  <div id="g_id_onload"
       data-client_id="880919546311-js43d7b2h0eq5lm29pg9mb80ilc53s4v.apps.googleusercontent.com"
       data-callback="handleCredentialResponse"
       data-auto_prompt="false">
  </div>
  <div class="g_id_signin"
       data-type="standard"
       data-size="large"
       data-theme="outline"
       data-shape="pill">
  </div>
</div>

<form id="classUpdateForm">

<div class="card">
<h3>Class Information</h3>

<label>Date</label>
<input type="text" id="date" name="date" readonly>

<label>Day</label>
<input type="text" id="day" name="day" readonly>

<label>Instructor (Verified)</label>
<input type="text" id="instructorDisplay" readonly>

<input type="hidden" name="instructorName" id="instructorName">
<input type="hidden" name="instructorEmail" id="instructorEmail">

<label>Start Time</label>
<div class="time-row">
<select name="startHour" required>
<option value="">HH</option>
<option>01</option><option>02</option><option>03</option>
<option>04</option><option>05</option><option>06</option>
<option>07</option><option>08</option><option>09</option>
<option>10</option><option>11</option><option>12</option>
</select>

<select name="startMinute" required>
<option value="">MM</option>
<option>00</option><option>05</option><option>10</option>
<option>15</option><option>20</option><option>25</option>
<option>30</option><option>35</option><option>40</option>
<option>45</option><option>50</option><option>55</option>
</select>

<select name="ampm" required>
<option value="">AM / PM</option>
<option>AM</option>
<option>PM</option>
</select>
</div>

<label>End Time</label>
<input type="text" id="endTime" name="endTime" readonly>

</div>

<div class="card">
<h3>Course Details</h3>

<select name="mode" required>
<option value="">Mode of Class</option>
<option>Offline</option>
<option>Online</option>
</select>

<select name="courseType" required>
<option value="">Course Type</option>
<option>Two-Year Diploma</option>
<option>One-Year Diploma</option>
<option>Certificate</option>
</select>

<select name="course" required>
<option value="">Course</option>
<option>OTT</option><option>MLT</option><option>EMT</option>
<option>ICU</option><option>MRT</option><option>ECG</option>
<option>PT</option><option>RMP</option><option>CMS & ED</option><option>NA</option>
</select>

<textarea name="topic" placeholder="Topic Taught" required></textarea>
</div>

<div class="card">
<button type="submit" id="submitBtn" disabled>Submit Class Update</button>
</div>

</form>
</div>

<!-- POPUP -->
<div class="popup-overlay" id="popupOverlay">
  <div class="popup-card" id="popupCard"></div>
</div>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbyHpuX4WLBGDImZdmBOSWLyRaQa6EBFBNYwlD7pvIjpKR7D-TZ4wDPTSfCA_MhDMzPugw/exec";

const now=new Date();
date.value=now.toLocaleDateString("en-GB");
day.value=now.toLocaleDateString("en-US",{weekday:"long"});
endTime.value=now.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});

function handleCredentialResponse(response){
const data=JSON.parse(atob(response.credential.split('.')[1]));
instructorDisplay.value=data.name;
instructorName.value=data.name;
instructorEmail.value=data.email;
loginBox.style.display="none";
submitBtn.disabled=false;
}

function showLoading(){
popupOverlay.style.display="flex";
popupCard.innerHTML=`
<div class="loader"></div>
<h3 style="margin-top:18px">Please wait...</h3>
<p>Your class update is submitting...</p>`;
}

function showSuccess(){
popupCard.innerHTML=`
<div class="checkmark">
<svg viewBox="0 0 100 100">
<circle cx="50" cy="50" r="40"/>
<path d="M30 52 L45 65 L70 38"/>
</svg>
</div>
<h3 style="margin-top:16px;color:#28a745">Submission Completed</h3>
<p style="font-weight:600">DONE</p>`;
setTimeout(()=>{popupOverlay.style.display="none"},3000);
}

classUpdateForm.addEventListener("submit",function(e){
e.preventDefault();
showLoading();
fetch(SCRIPT_URL,{method:"POST",body:new FormData(this)})
.then(r=>r.json())
.then(()=>{showSuccess();this.reset();})
.catch(()=>{popupCard.innerHTML="<h3 style='color:red'>‚ùå Submission Failed</h3>";});
});
</script>

</body>
</html>
